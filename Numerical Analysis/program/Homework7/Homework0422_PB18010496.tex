\documentclass{ctexart}
\textheight 23.5cm \textwidth 15.8cm
%\leftskip -1cm
\topmargin -1.5cm \oddsidemargin 0.3cm \evensidemargin -0.3cm

\usepackage{verbatim}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{float}

\CTEXsetup[format={\Large\bfseries}]{section}

\title{Homework-Numerical integration}
\author{PB18010496 杨乐园}
\date{\today}


\begin{document}
\maketitle

\section{Introduction}
分别编写用复化Simpson积分公式与复化梯形积分公式计算积分的通用程序，并用如上程序计算积分值
\begin{displaymath}
  I(f)=\int_{0}^{4} \sin x dx 
\end{displaymath}
取节点
\begin{displaymath}
  x_{i}=a+ih,\quad h=\frac{b-a}{N}, \quad i=0,1,...,N, \quad N=2^{k},\quad k=1,...,12 
\end{displaymath}
并计算相应的误差收敛阶。

\section{Method}

通过Mathematica编程，首先构造相应结点列$x_{i}$，之后直接利用相应的数值积分公式直接计算即可，其中为了输出与运行方便，将程序写成对任意函数与任意$k$通用的程序，实现Module块化。

复化Simpson积分公式为：
\begin{displaymath}
  \int_{a}^{b} f(x) dx \approx 
  \frac{h}{3} \sum_{i=1}^{n/2} [ f(x_{2i-2})+4f(x_{2i-1})+f(x_{2i}) ]
\end{displaymath}

复化梯形积分公式为：
\begin{displaymath}
  \int_{a}^{b} f(x) dx \approx \frac{h}{2} [ f(a)+2\sum_{i=1}^{n-1}f(x_{i})+f(b) ]
\end{displaymath}

收敛阶计算公式为：
\begin{displaymath}
  Ord=\frac{ln(Error_{old}/Error_{new})}{ln(N_{new}/N_{old})}
\end{displaymath}

\section{Results}
输出结果如下：
\begin{figure}[H]
  \begin{center}
    \includegraphics[width=1.0\textwidth]{result.png}
  \end{center}
\end{figure}


\section{Discussion}

通过对数据的观察我们发现：

两种数值积分计算公式都较好的给出了积分的数值积分值，随着$N$的增大，两种积分计算公式的误差均显著下降，其中复化Simpson公式计算的积分值误差均小于复化梯形积分误差，且收敛速度更快，其中复化Simpson积分误差成4阶收敛，而复化梯形积分误差成2阶收敛，较好的印证了理论结果。

\section{Computer Code}

代码部分请参见附件!(Homework7\_0422.nb)。

\end{document}
