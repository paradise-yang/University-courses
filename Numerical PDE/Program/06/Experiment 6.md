# $Experiment 6：$具有间断系数的线性扩散方程

## 杨乐园  PB18010496

#### 问题描述

  1. 针对下述具有间断系数的线性扩散方程：
     $$
     u_t=(a(x,t)u_x)_x,\qquad
     a(x,t)=\left\{
     \begin{array}{rl}
     4.0 & x<0  \\
     1.0 & x>0
     \end{array}
     \right.
     $$

考虑$Dirichlet$零边值问题，并设真解为:
$$
u(x,t)=\left \{
\begin{array}{rl}
\frac{1}{2}e^{-4t}\sin x & x\in [-\pi,0]  \\
e^{-4t}\sin(2x) & x\in [0,\pi]
\end{array}\right.
$$
取网格剖分$J=21,41,81,161,321$，网格比为$\mu=\frac{\Delta t}{\Delta x^{2}}=0.1$。并计算终止时刻为$T=1.0$时算数平均格式、调和平均格式两种格式的$L^{2}$误差、$L^{\infin}$误差以及对应的精度阶，并进行分析。

#### 数值方法

​		数值格式：
$$
v_{j}^{n+1}=v_{j}^{n}+\mu[a_{j+\frac{1}{2}}^{n}(v_{j+1}^{n}-v_{j}^{n})-a_{j-\frac{1}{2}}^{n}(v_{j}^{n}-v_{j-1}^{n})]
$$
可以数值保持热量内部的局部守恒性质。针对$a_{j+\frac{1}{2}}^{n}$有如下i两种计算方式：

$\bullet$算术平均方式：
$$
a_{j+\frac{1}{2}}^{n}=\frac{1}{2}(a_{j}^{n}+a_{j+1}^{n})
$$
$\bullet$调和平均方式：
$$
a_{j+\frac{1}{2}}^{n}=[\frac{\theta_{j+\frac{1}{2}}^{n}}{a_{j}^{n}}+\frac{1-\theta_{j+\frac{1}{2}}^{n}}{a_{j+1}^{n}}]^{-1},\qquad 
where \ \ \theta_{j+\frac{1}{2}}^{n}=
\left \{
\begin{array}{ll}
\frac{(x_{*}-x_{j})}{\Delta x}, & x_{*}\in[x_{j},x_{j+1}]  \\
\frac{1}{2}, & otherelse
\end{array}\right.
$$

#### 数值结果

​		我们有如下数值求解结果：

$\bullet$算术平均：

| N    | $L^{2}$误差 | 收敛阶   | $L^{\infin}$误差 | 收敛阶   |
| ---- | ----------- | -------- | ---------------- | -------- |
| 21   | 0.00910807  | ——       | 0.006348770      | ——       |
| 41   | 0.00464686  | 1.00586  | 0.003450060      | 0.911544 |
| 81   | 0.00237368  | 0.986595 | 0.001813090      | 0.944901 |
| 161  | 0.00120462  | 0.987363 | 0.000934317      | 0.965085 |
| 321  | 0.000607519 | 0.992033 | 0.000474821      | 0.980929 |

$\bullet$调和平均：

| N    | $L^{2}$误差 | 收敛阶  | $L^{\infin}$误差 | 收敛阶  |
| ---- | ----------- | ------- | ---------------- | ------- |
| 21   | 0.00297699  | ——      | 0.00182199       | ——      |
| 41   | 0.000774868 | 2.01177 | 0.000484301      | 1.98039 |
| 81   | 0.000199385 | 1.99369 | 0.00012709       | 1.96484 |
| 161  | 5.02216e-05 | 2.00711 | 3.17082e-05      | 2.02097 |
| 321  | 1.24393e-05 | 2.02248 | 7.52981e-06      | 2.08352 |

​		我们可以明显的看到，算术平均格式收敛阶为$1$，而调和平均格式收敛阶为$2$，可见，调和平均格式给出的数值效果更佳。具体表现为：
$$
2(\frac{1}{a_{j}^{n}}+\frac{1}{a_{j+1}^{n}})^{-1}-\frac{1}{2}(a_{j}^{n}+a_{j+1}^{n})=O((\Delta x)^{2})
$$


#### 代码

​		其中数值求解代码与绘图代码参见附件！

